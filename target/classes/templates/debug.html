<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Debug - Database Contents</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-4">
        <h2>Database Debug Information</h2>
        
        <div class="row">
            <div class="col-md-12">
                <h4>API Test Results:</h4>
                <button class="btn btn-primary" onclick="testAPI()">Test All APIs</button>
                <div id="apiResults" class="mt-3"></div>
            </div>
        </div>
    </div>

    <script>
        async function testAPI() {
            const results = document.getElementById('apiResults');
            results.innerHTML = '<div class="spinner-border"></div> Testing APIs...';
            
            let html = '<div class="row">';
            
            try {
                // Test 1: Get Interviewers
                const interviewersResponse = await fetch('/api/v1/interviewers');
                const interviewers = await interviewersResponse.json();
                
                html += `
                    <div class="col-md-6 mb-3">
                        <div class="card">
                            <div class="card-header">
                                <h5>Interviewers (${interviewers.length})</h5>
                            </div>
                            <div class="card-body">
                                <pre>${JSON.stringify(interviewers, null, 2)}</pre>
                            </div>
                        </div>
                    </div>
                `;
                
                // Test 2: Get slots for each interviewer
                for (const interviewer of interviewers) {
                    try {
                        const slotsResponse = await fetch(`/api/v1/interview-slots/interviewer/${interviewer.id}`);
                        const slots = await slotsResponse.json();
                        
                        html += `
                            <div class="col-md-6 mb-3">
                                <div class="card">
                                    <div class="card-header">
                                        <h5>Slots for ${interviewer.name} (${slots.length})</h5>
                                    </div>
                                    <div class="card-body">
                                        <pre>${JSON.stringify(slots, null, 2)}</pre>
                                    </div>
                                </div>
                            </div>
                        `;
                    } catch (error) {
                        html += `
                            <div class="col-md-6 mb-3">
                                <div class="card border-danger">
                                    <div class="card-header bg-danger text-white">
                                        <h5>Error loading slots for ${interviewer.name}</h5>
                                    </div>
                                    <div class="card-body">
                                        <p>${error.message}</p>
                                    </div>
                                </div>
                            </div>
                        `;
                    }
                }
                
                // Test 3: Available slots API
                const availableResponse = await fetch('/api/v1/interview-slots/available?limit=50');
                const availableData = await availableResponse.json();
                
                html += `
                    <div class="col-md-12 mb-3">
                        <div class="card">
                            <div class="card-header">
                                <h5>Available Slots API Response</h5>
                            </div>
                            <div class="card-body">
                                <pre>${JSON.stringify(availableData, null, 2)}</pre>
                            </div>
                        </div>
                    </div>
                `;
                
            } catch (error) {
                html += `
                    <div class="col-md-12">
                        <div class="alert alert-danger">
                            <h4>API Test Failed</h4>
                            <p>${error.message}</p>
                        </div>
                    </div>
                `;
            }
            
            html += '</div>';
            results.innerHTML = html;
        }
        
        // Auto-run on page load
        document.addEventListener('DOMContentLoaded', testAPI);
    </script>
</body>
</html>